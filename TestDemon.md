# Общие сведения #

Демон слушает порт под номером 17675 при, подключении нового клиента он (клиент) добавляется в пул клиентов.
При возникновении события disconnect клиент удаляется из пула

# Как работает демон #
Сервер ожидает сообщения(команды)от клиентов в виде **СТРОКА\n**

После подключения нового клиента сервер ждет команды технической авторизации клиента в виде:

**/me:{3358c5cb-4be3-48f4-bec8-8bfdf42b0b53}**,

где {хххх...} уникальный идентификатор клиента. Если сервер получил данное сообщение, то он записывает во внутреннем хеше **QMap<QTcpSocket_,QString> clientsUID_ привязку клиента к сокету.**

```
 clientsUID[client] = cUID;
```
Если от клиента получено сообщение, не подходящее под этот шаблон, происходит проверка на предмет не был ли клиент уже зарегистрирован

```
if(clientsUID.contains(client))
```

В случае успеха происходит попытка разобрать пришедшее сообщение от клиента как команду.
Общий формат команды:
**/cmd:идентификатор\_команды:тело команды**

Список команд описан в классе **BoxServer**
```
	enum TypeCmd
	{
	    getPrinterListCmd,
	    setDocStateCmd
	};

```

Коды команд начинаются с нуля

Основная функция демона
```
	void doCommand(const QString &user,int command,const QString &body);
```
Которая выполняет полученные от клиента команды

В тестовом демоне написана заглушка которая для отладки возвращает список принтеров
```
Testprinter1,TestPrinter2,TestPrinter3,TestPrinter4
```